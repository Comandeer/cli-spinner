/*! @comandeer/cli-spinner v0.1.0 | (c) 2021 Comandeer | MIT license (see LICENSE) */
import{Writable as t,Duplex as e}from"stream";import r from"console-control-strings";const s=["/","-","\\","|"],i=Symbol("timeout"),n=Symbol("currentFrame"),o=Symbol("showing"),a=r.gotoSOL()+r.eraseLine();class h{constructor({stdout:r=process.stdout,label:a="",spinner:h=s,interval:u=80}={}){if(!((m=r)instanceof t||m instanceof e))throw new TypeError("Custom stdout must be a valid writable/duplex stream");var m;if("number"!=typeof u)throw new TypeError("Custom interval must be a valid number");if("string"!=typeof a)throw new TypeError("Custom label must be a valid string");if(!function(t){return Array.isArray(t)&&t.every((t=>"string"==typeof t))}(h))throw new TypeError("Custom spinner must be a valid array of strings");this.stdout=r,this.label=a,this.spinner=h,this.interval=u,this[i]=null,this[n]=0,this[o]=!1}show(){if(this[o])return;const t=()=>{const e=this._prepareSpinnerFrame();this._requestRenderFrame(e).then((()=>{this[i]=setTimeout(t,this.interval)}))};this[o]=!0,this._requestRenderFrame(r.hideCursor()).then(t)}hide(){this[o]&&(this[i]&&clearTimeout(this[i]),this._requestRenderFrame(a+r.showCursor()).then((()=>{this[n]=0,this[o]=!1})))}_prepareSpinnerFrame(){const t=this.spinner[this[n]++%this.spinner.length];return`${a+t} ${this.label}`}_requestRenderFrame(t){return new Promise((e=>{if(this.stdout.write(t,"utf8"))return e();this.stdout.once("drain",e)}))}}export{h as default};
//# sourceMappingURL=cli-spinner.mjs.map
